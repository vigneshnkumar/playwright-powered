<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Financial Application Portal - Demo</title>
    <style>
        body { 
            font-family: 'Segoe UI', sans-serif; 
            padding: 20px; 
            max-width: 800px; 
            margin: 0 auto;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 { color: #333; margin-bottom: 10px; }
        .subtitle { color: #666; margin-bottom: 30px; font-size: 14px; }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #0066cc;
        }
        .error {
            color: #d9534f;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        .error.visible { display: block; }
        button {
            background: #0066cc;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
        }
        button:hover { background: #0052a3; }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .secure-zone { 
            background: #d4edda;
            border: 2px solid #28a745;
            padding: 20px;
            border-radius: 8px;
            display: none;
        }
        .secure-zone.visible { display: block; }
        .hidden { display: none; }
        .conditional-field {
            background: #fff3cd;
            padding: 15px;
            border-left: 3px solid #ffc107;
            margin-top: 15px;
        }
        #status-message {
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 20px;
            display: none;
        }
        #status-message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        #status-message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Financial Application Portal</h1>
        <p class="subtitle">Secure regulatory compliance form - Demo for Selenium to Playwright migration</p>
        
        <div id="status-message" data-testid="status-message"></div>

        <div id="login-form">
            <!-- Basic Login Fields -->
            <div class="form-group">
                <label for="user">Username *</label>
                <input 
                    type="text" 
                    id="user" 
                    data-testid="username-input" 
                    placeholder="Enter username"
                    required>
                <div id="user-error" class="error">Username is required (min 3 characters)</div>
            </div>
            
            <div class="form-group">
                <label for="pass">Password *</label>
                <input 
                    type="password" 
                    id="pass" 
                    data-testid="password-input" 
                    placeholder="Enter password"
                    required>
                <div id="pass-error" class="error">Password is required (min 6 characters)</div>
            </div>

            <!-- Additional Fields for Demo -->
            <div class="form-group">
                <label for="email">Email *</label>
                <input 
                    type="email" 
                    id="email" 
                    data-testid="email-input" 
                    placeholder="user@example.com"
                    required>
                <div id="email-error" class="error">Valid email is required</div>
            </div>

            <div class="form-group">
                <label for="account-type">Account Type *</label>
                <select id="account-type" data-testid="account-type-select" required>
                    <option value="">-- Select Account Type --</option>
                    <option value="individual">Individual</option>
                    <option value="business">Business</option>
                    <option value="institutional">Institutional Investor</option>
                </select>
                <div id="account-type-error" class="error">Please select an account type</div>
            </div>

            <!-- Conditional Field: Business Details (appears when Business is selected) -->
            <div id="business-fields" class="conditional-field hidden" data-testid="business-fields">
                <h3 style="margin-top: 0;">Business Information</h3>
                <div class="form-group">
                    <label for="company-name">Company Name *</label>
                    <input 
                        type="text" 
                        id="company-name" 
                        data-testid="company-name-input" 
                        placeholder="Enter company name">
                    <div id="company-error" class="error">Company name is required for business accounts</div>
                </div>
                
                <div class="form-group">
                    <label for="tax-id">Tax ID / EIN *</label>
                    <input 
                        type="text" 
                        id="tax-id" 
                        data-testid="tax-id-input" 
                        placeholder="XX-XXXXXXX"
                        pattern="\d{2}-\d{7}">
                    <div id="tax-error" class="error">Tax ID format: XX-XXXXXXX (e.g., 12-3456789)</div>
                </div>
            </div>

            <!-- Conditional Field: Institutional Details -->
            <div id="institutional-fields" class="conditional-field hidden" data-testid="institutional-fields">
                <h3 style="margin-top: 0;">Institutional Investor Information</h3>
                <div class="form-group">
                    <label for="institution-name">Institution Name *</label>
                    <input 
                        type="text" 
                        id="institution-name" 
                        data-testid="institution-name-input" 
                        placeholder="Enter institution name">
                </div>
                
                <div class="form-group">
                    <label for="regulatory-id">Regulatory ID (SEC/FINRA) *</label>
                    <input 
                        type="text" 
                        id="regulatory-id" 
                        data-testid="regulatory-id-input" 
                        placeholder="Enter regulatory ID">
                </div>
            </div>

            <button 
                id="login-btn" 
                data-testid="submit-btn" 
                onclick="submitApplication()">
                Submit Application
            </button>
        </div>

        <!-- Secure Area (shown after successful login) -->
        <div id="secure-area" class="secure-zone" data-testid="secure-area">
            <h2>âœ“ Application Submitted Successfully</h2>
            <p><strong>Welcome, <span id="username-display">Admin</span>!</strong></p>
            <p>Your session token: <span id="token-value" data-testid="token-display">JWT-888-SECRET</span></p>
            <p>Account Type: <span id="account-type-display">N/A</span></p>
            
            <div class="form-group" style="margin-top: 20px;">
                <label for="regions">Select Server Region:</label>
                <select id="regions" data-testid="region-select">
                    <option value="us-east-1">US East (N. Virginia)</option>
                    <option value="us-west-2">US West (Oregon)</option>
                    <option value="eu-west-1">EU West (Ireland)</option>
                    <option value="ap-southeast-1">Asia Pacific (Singapore)</option>
                </select>
            </div>

            <button onclick="logout()" style="background: #6c757d; margin-top: 20px;">
                Logout
            </button>
        </div>
    </div>

    <script>
        // Track which account type is selected
        const accountTypeSelect = document.getElementById('account-type');
        const businessFields = document.getElementById('business-fields');
        const institutionalFields = document.getElementById('institutional-fields');

        // Show/hide conditional fields based on account type
        accountTypeSelect.addEventListener('change', function() {
            const selectedType = this.value;
            
            // Hide all conditional fields first
            businessFields.classList.add('hidden');
            institutionalFields.classList.add('hidden');
            
            // Show relevant conditional fields
            if (selectedType === 'business') {
                businessFields.classList.remove('hidden');
            } else if (selectedType === 'institutional') {
                institutionalFields.classList.remove('hidden');
            }
        });

        function validateForm() {
            let isValid = true;
            
            // Clear previous errors
            document.querySelectorAll('.error').forEach(el => el.classList.remove('visible'));
            
            // Username validation
            const username = document.getElementById('user').value;
            if (!username || username.length < 3) {
                document.getElementById('user-error').classList.add('visible');
                isValid = false;
            }
            
            // Password validation
            const password = document.getElementById('pass').value;
            if (!password || password.length < 6) {
                document.getElementById('pass-error').classList.add('visible');
                isValid = false;
            }
            
            // Email validation
            const email = document.getElementById('email').value;
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email || !emailRegex.test(email)) {
                document.getElementById('email-error').classList.add('visible');
                isValid = false;
            }
            
            // Account type validation
            const accountType = accountTypeSelect.value;
            if (!accountType) {
                document.getElementById('account-type-error').classList.add('visible');
                isValid = false;
            }
            
            // Conditional validation for business
            if (accountType === 'business') {
                const companyName = document.getElementById('company-name').value;
                if (!companyName || companyName.length < 2) {
                    document.getElementById('company-error').classList.add('visible');
                    isValid = false;
                }
                
                const taxId = document.getElementById('tax-id').value;
                const taxIdRegex = /^\d{2}-\d{7}$/;
                if (!taxId || !taxIdRegex.test(taxId)) {
                    document.getElementById('tax-error').classList.add('visible');
                    isValid = false;
                }
            }
            
            // Conditional validation for institutional
            if (accountType === 'institutional') {
                const institutionName = document.getElementById('institution-name').value;
                const regulatoryId = document.getElementById('regulatory-id').value;
                if (!institutionName || !regulatoryId) {
                    showStatusMessage('Please fill all institutional fields', 'error');
                    isValid = false;
                }
            }
            
            return isValid;
        }

        function submitApplication() {
            if (!validateForm()) {
                showStatusMessage('Please correct the errors above', 'error');
                return;
            }
            
            // Get form values
            const username = document.getElementById('user').value;
            const accountType = accountTypeSelect.value;
            
            // Update secure area with user info
            document.getElementById('username-display').textContent = username;
            document.getElementById('account-type-display').textContent = 
                accountType.charAt(0).toUpperCase() + accountType.slice(1);
            
            // Show success and transition to secure area
            showStatusMessage('Application validated successfully!', 'success');
            
            setTimeout(() => {
                document.getElementById('login-form').style.display = 'none';
                document.getElementById('secure-area').classList.add('visible');
                document.getElementById('status-message').style.display = 'none';
            }, 800);
        }

        function logout() {
            document.getElementById('secure-area').classList.remove('visible');
            document.getElementById('login-form').style.display = 'block';
            
            // Reset form
            document.getElementById('user').value = '';
            document.getElementById('pass').value = '';
            document.getElementById('email').value = '';
            accountTypeSelect.value = '';
            businessFields.classList.add('hidden');
            institutionalFields.classList.add('hidden');
            
            // Clear errors
            document.querySelectorAll('.error').forEach(el => el.classList.remove('visible'));
        }

        function showStatusMessage(message, type) {
            const statusEl = document.getElementById('status-message');
            statusEl.textContent = message;
            statusEl.className = type;
            statusEl.style.display = 'block';
        }

        // Demo: Pre-populate valid credentials for testing (remove in production)
        // Uncomment for quick testing:
        // document.getElementById('user').value = 'admin';
        // document.getElementById('pass').value = 'password123';
        // document.getElementById('email').value = 'admin@example.com';
    </script>
</body>
</html>